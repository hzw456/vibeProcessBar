## 上下文

Vibe Coding 进度栏是一款专为 AI 辅助编程设计的桌面工具。产品以悬浮窗形式实时监控 AI 代码生成进度，支持窗口快速切换、进度可视化提醒，让开发者在 AI 执行任务时可以进行其他工作。

**约束条件：**
- 使用 Tauri 框架（Rust + Web 前端）
- 需支持 macOS、Windows、Linux
- 资源占用需轻量，不影响开发者正常工作
- 悬浮窗需支持透明背景和置顶显示

**利益相关者：** 开发者、AI 编程工具用户

## 目标 / 非目标

**目标：**
- 提供轻量级悬浮窗实时显示 AI 代码生成进度
- 支持主流 AI 编程工具的进度监控
- 实现窗口快速切换和多任务管理
- 提供进度可视化提醒（动画、声音、通知）

**非目标：**
- 不实现 AI 代码生成功能（专注于进度监控）
- 不集成特定的 IDE 插件（提供通用 API）
- 不支持移动端平台

## 决策

**1. 框架选择：Tauri + React**

- **决策：** 使用 Tauri 作为桌面框架，React 作为前端框架
- **替代方案考虑：**
  - Electron + React：功能成熟但资源占用大（~100MB+）
  - Tauri + Vue：Vue 简单但生态不如 React 丰富
- **理由：** Tauri 资源占用小（~10MB），且 React 生态丰富，适合复杂 UI

**2. 悬浮窗实现**

- **决策：** 使用 Tauri 窗口 API 实现可配置透明度的悬浮窗
- **替代方案考虑：**
  - 系统级悬浮窗 API：跨平台兼容性差
  - 无边框窗口 + 透明背景：Tauri 原生支持
- **理由：** Tauri 提供稳定的跨平台窗口管理能力

**3. 进度监控架构**

- **决策：** 采用插件化架构，通过适配器模式支持不同 AI 工具
- **替代方案考虑：**
  - 硬编码支持特定工具：扩展性差
  - 通用 API + 文档：灵活性高但集成成本高
- **理由：** 平衡扩展性和集成难度，提供标准适配器接口

**4. 存储方案**

- **决策：** 使用 Tauri 的-tauri 配置文件 + 轻量级 SQLite
- **替代方案考虑：**
  - 纯 JSON 文件：简单但查询能力弱
  - Tauri Store 插件：够用但功能有限
- **理由：** 需存储用户设置和历史记录，SQLite 足够轻量

## 风险 / 权衡

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 跨平台窗口行为差异 | 悬浮窗在 Linux 上可能表现不一致 | 提供平台特定配置 |
| AI 工具 API 变化 | 适配器可能需要频繁更新 | 设计版本化适配器接口 |
| 资源占用累积 | 长时间运行可能导致内存增长 | 实现资源清理机制 |

## 迁移计划

**第一阶段（核心功能）：**
- 实现基础悬浮窗和进度显示
- 提供手动输入进度功能
- 支持基础窗口管理

**第二阶段（集成功能）：**
- 添加主流 AI 工具适配器
- 实现自动进度检测
- 添加进度提醒功能

**回滚方案：**
- 保留配置文件备份机制
- 支持导出/导入用户设置

## 开放问题

- [ ] 是否需要支持自定义进度栏外观主题？
- [ ] 是否需要集成到系统托盘？
- [ ] 进度数据的持久化周期如何设定？
