## ADDED Requirements

### Requirement: 悬浮窗显示

系统 SHALL 提供一个可配置的悬浮窗，用于实时显示 AI 代码生成进度。

悬浮窗 SHALL 支持透明背景和置顶显示。

悬浮窗 SHALL 占用最小屏幕空间（默认 200x60 像素）。

#### Scenario: 启动时显示悬浮窗

- **WHEN** 用户启动应用程序
- **THEN** 系统显示悬浮窗在屏幕默认位置
- **AND** 悬浮窗显示初始状态（"准备就绪"）

#### Scenario: 悬浮窗透明度和位置配置

- **WHEN** 用户在设置中调整透明度
- **THEN** 悬浮窗背景透明度实时更新
- **AND** 用户可以拖拽悬浮窗到任意位置
- **AND** 系统记住最后位置并在下次启动时恢复

#### Scenario: 悬浮窗主题切换

- **WHEN** 用户切换主题（浅色/深色/自定义）
- **THEN** 悬浮窗颜色方案实时更新
- **AND** 所有 UI 组件使用新主题颜色

### Requirement: 进度监控

系统 SHALL 实时监控和显示 AI 代码生成的当前进度。

系统 SHALL 支持手动输入和自动检测两种进度更新方式。

系统 SHALL 显示进度百分比、状态文本和预计剩余时间。

#### Scenario: 手动输入进度

- **WHEN** 用户在悬浮窗中输入 75
- **THEN** 进度栏显示 75% 完成
- **AND** 显示文本 "75% - 代码生成中"
- **AND** 进度条动画反映当前进度

#### Scenario: 自动检测进度

- **WHEN** AI 编程工具通过 API 发送进度更新
- **THEN** 系统自动更新进度显示
- **AND** 无需用户手动干预
- **AND** 进度变化有平滑过渡动画

#### Scenario: 多任务进度管理

- **WHEN** 用户启动多个 AI 任务
- **THEN** 系统创建多个进度卡片
- **AND** 用户可以通过快捷键或点击切换显示
- **AND** 完成的任务自动标记并可折叠

### Requirement: AI 工具适配器

系统 SHALL 提供插件化架构，支持多种 AI 编程工具的进度监控。

系统 SHALL 预置主流 AI 工具的适配器（GitHub Copilot, Claude Code, Cursor 等）。

系统 SHALL 提供标准 API 供自定义适配器使用。

#### Scenario: GitHub Copilot 进度监控

- **WHEN** GitHub Copilot 生成代码时
- **THEN** 系统通过 Copilot 扩展 API 获取进度
- **AND** 实时更新悬浮窗显示
- **AND** 显示当前生成的文件名和行数

#### Scenario: Claude Code 集成

- **WHEN** Claude Code 执行代码生成任务时
- **THEN** 系统通过 Claude Code CLI 监听进度
- **AND** 显示任务阶段（分析、生成、优化）
- **AND** 显示已完成/总步骤数

#### Scenario: 自定义适配器

- **WHEN** 用户实现自定义适配器
- **THEN** 适配器遵循标准接口规范
- **AND** 适配器可动态加载
- **AND** 系统提供适配器开发文档和示例

### Requirement: 进度提醒

系统 SHALL 在进度状态变化时提供多种提醒方式。

系统 SHALL 支持系统通知、视觉提示和声音提醒。

系统 SHALL 允许用户配置提醒阈值和免打扰模式。

#### Scenario: 进度完成通知

- **WHEN** 进度达到 100%
- **THEN** 系统发送完成通知
- **AND** 悬浮窗显示完成动画
- **AND** 播放提示音（如果启用）

#### Scenario: 长时间任务提醒

- **WHEN** 任务超过预设时间阈值（默认 30 分钟）
- **THEN** 系统发送超时提醒
- **AND** 显示已运行时间
- **AND** 询问用户是否继续等待

#### Scenario: 提醒免打扰

- **WHEN** 用户启用免打扰模式
- **THEN** 系统暂停所有通知
- **AND** 进度正常更新但无提醒
- **AND** 免打扰可设置定时或手动关闭

### Requirement: 窗口管理

系统 SHALL 提供便捷的窗口管理功能，支持快速切换和隐藏。

系统 SHALL 支持全局快捷键操作。

系统 SHALL 兼容多显示器环境。

#### Scenario: 全局快捷键操作

- **WHEN** 用户按下 Alt+P（默认快捷键）
- **THEN** 悬浮窗显示/隐藏切换
- **AND** 快捷键可在设置中自定义

#### Scenario: 多显示器支持

- **WHEN** 用户有多个显示器
- **THEN** 悬浮窗可拖动到任一显示器
- **AND** 系统记住每个显示器上的位置
- **AND** 新显示器连接时提示用户放置

#### Scenario: 窗口预设位置

- **WHEN** 用户保存当前窗口位置为预设
- **THEN** 系统记住该位置
- **AND** 用户可通过快捷键快速切换到预设位置
- **AND** 最多支持 5 个预设位置

### Requirement: 系统集成

系统 SHALL 与操作系统深度集成，提供开机自启动和系统托盘支持。

系统 SHALL 在后台持续运行，不影响用户正常工作。

系统 SHALL 资源占用低，内存使用不超过 50MB。

#### Scenario: 开机自启动

- **WHEN** 用户启用开机自启动
- **THEN** 系统在用户登录后自动启动
- **AND** 悬浮窗显示在最后记录的位置
- **AND** 自启动可在设置中禁用

#### Scenario: 系统托盘集成

- **WHEN** 用户最小化或隐藏悬浮窗
- **THEN** 系统显示托盘图标
- **AND** 点击托盘图标显示悬浮窗
- **AND** 托盘图标显示当前进度状态

#### Scenario: 后台运行

- **WHEN** 没有活动任务超过 5 分钟
- **THEN** 系统进入低功耗模式
- **AND** 资源占用降低 50%
- **AND** 新任务到来时自动恢复

### Requirement: 设置管理

系统 SHALL 提供直观的设置界面，允许用户自定义所有功能。

系统 SHALL 支持配置的导入和导出。

系统 SHALL 实时保存设置变更。

#### Scenario: 常规设置

- **WHEN** 用户修改常规设置
- **THEN** 设置实时生效
- **AND** 无需重启应用程序
- **AND** 错误配置有提示和回滚

#### Scenario: 配置导入导出

- **WHEN** 用户导出配置
- **THEN** 系统生成配置文件
- **AND** 包含所有用户设置
- **AND** 不包含敏感数据

#### Scenario: 重置默认设置

- **WHEN** 用户选择重置默认设置
- **THEN** 所有设置恢复为初始值
- **AND** 悬浮窗位置和外观重置
- **AND** 用户确认后才执行
